<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/x-icon">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dayman maak</title>

        <style>
            @keyframes fadeInUp {
                0% {
                    opacity: 0;
                    transform: translateY(30px);
                }

                100% {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes bounceIn {
                0% {
                    opacity: 0;
                    transform: scale(0.5);
                }

                60% {
                    opacity: 1;
                    transform: scale(1.05);
                }

                100% {
                    transform: scale(1);
                }
            }

            @keyframes float {

                0%,
                100% {
                    transform: translateY(0);
                }

                50% {
                    transform: translateY(-20px);
                }
            }


            .logo img {
                animation: bounceIn 1.2s ease-out forwards;
                width: 80px;
            }

            .welcome {
                animation: fadeInUp 1s ease-out forwards;
                animation-delay: 0.4s;
                opacity: 0;
            }

            section .title {
                animation: fadeInUp 1s ease forwards;
                animation-delay: 0.5s;
                opacity: 0;
            }


            .container {
                padding: 20px;
                text-align: center;
            }

            .content .container {
                display: flex;
                gap: 20px;
                justify-content: center;
                flex-wrap: wrap;
            }

            .icon {
                font-size: 40px;
                color: rgb(255, 111, 0);
                margin-bottom: 10px;
            }
        </style>


    <body>
        <!-- Header -->
        <header class="main-header">
            <div class="container header-container">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Dayman Maak Logo" class="logo" />

                <div class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>

                <nav class="nav-menu" id="nav-menu">
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/info">Places</a></li>
                        <li><a href="/chatbot">Chatbot</a></li>
                        <li><a href="/#services">Services</a></li>
                        <li><a href="/#community">Community</a></li>
                        <li><a href="/map">Map</a></li>

                        <li><a href="/#contact">Contact</a></li>


                    </ul>
                </nav>
            </div>
        </header>


        <script>
            //when click on humburger icon change from ‚ò∞ to rotate 90 degreed X
            const me = document.querySelector(".menu-toggle");
            const navMenu = document.getElementById("nav-menu");

            me.addEventListener("click", () => {
                me.classList.toggle("rotate");
                setTimeout(() => {
                    navMenu.classList.toggle("active");
                }, 200);
                setTimeout(() => {
                    me.classList.toggle("rotate_");
                    me.classList.remove("rotate");
                }, 500);

            });

        </script>
        <style>
            /* Rotate animation */
            .rotate {
                animation: rotate 0.5s linear;
            }

            @keyframes rotate {
                from {
                    transform: rotate(0deg);
                }

                to {
                    transform: rotate(90deg);
                }

                /*stop at 90 degrees*/
                100% {
                    transform: rotate(90deg);
                }
            }

            .rotate_ {
                transform: rotate(90deg);
            }
        </style>

        <style>
            @keyframes bounceIn {
                0% {
                    opacity: 0;
                    transform: scale(0.5);
                }

                60% {
                    opacity: 1;
                    transform: scale(1.05);
                }

                100% {
                    transform: scale(1);
                }
            }



            .logo img {
                animation: bounceIn 1.2s ease-out forwards;
                width: 80px;
            }
        </style>
        <div id="chatContainer">
            <h2>Chat with TravelBot ü§ñ</h2>
            <div id="chatLog"></div>
            <div class="chat-input">
                <input type="text" id="userInput" placeholder="Type your question...">
                <button id="sendButton" onclick="sendMessage()">Send</button>
                <button id="micButton" onclick="startSpeechRecognition()">
                    <i class="fa-solid fa-microphone"></i>
                </button>


            </div>

        </div>

        <style>
            /* Chat Container */
            #chatContainer {
                width: 30%;
                margin: 50px auto;
                border: 2px solid #2c3e50;
                border-radius: 15px;
                padding: 15px;
                background: #df6c00;
                box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
                display: flex;
                flex-direction: column;
            }

            /* Chat Header */
            #chatContainer h2 {
                text-align: center;
                margin-bottom: 10px;
                color: #ffffff;
            }

            /* Chat Log */
            #chatLog {
                flex: 1;
                min-height: 300px;
                max-height: 400px;
                overflow-y: auto;
                border: 1px solid #ddd;
                border-radius: 10px;
                padding: 10px;
                background: #fff;
            }

            /* Messages */
            .user-message {
                text-align: right;
                background: #d1f7c4;
                padding: 8px 12px;
                margin: 5px;
                border-radius: 15px 15px 0 15px;
                display: inline-block;
                max-width: 80%;
            }

            .bot-message {
                text-align: left;
                background: #e0e0e0;
                padding: 8px 12px;
                margin: 5px;
                border-radius: 15px 15px 15px 0;
                display: inline-block;
                max-width: 80%;
            }

            /* Input area */
            .chat-input {
                display: flex;
                margin-top: 10px;
            }

            #userInput {
                flex: 1;
                padding: 10px;
                border-radius: 10px 0 0 10px;
                border: 1px solid #ccc;
                font-size: 1em;
            }

            #sendButton {
                padding: 10px 20px;
                border: none;
                background: #2c3e50;
                color: #fff;
                font-size: 1em;
                border-radius: 0 10px 10px 0;
                cursor: pointer;
                transition: background 0.3s ease;
            }

            #sendButton:hover {
                background: #1a242f;
            }

            /* Responsive Design */
            @media (max-width: 600px) {
                #chatContainer {
                    width: 95%;
                    padding: 10px;
                }

                #chatLog {
                    min-height: 200px;
                    max-height: 300px;
                }

                #userInput {
                    font-size: 0.9em;
                }

                #sendButton {
                    padding: 10px;
                    font-size: 0.9em;
                }
            }

            .chat-input button {
                padding: 10px;
                border: none;
                margin-left: 5px;
                cursor: pointer;
                font-size: 1.1em;
                border-radius: 8px;
                transition: background 0.3s;
            }

            #sendButton {
                background: #004d99;
                color: #fff;
            }

            #micButton {
                background: #ff6f00;
                color: #fff;
                border-radius: 50%;
            }

            #micButton:hover {
                background: #e65c00;
            }

            .chat-input button:last-child {
                background: #28a745;
                color: #fff;
            }
        </style>

        <script>
            function speakResponse() {
                const chatLog = document.getElementById("chatLog");
                const lastBotMsg = chatLog.querySelector(".bot-message:last-child");

                if (lastBotMsg) {
                    const text = lastBotMsg.textContent;
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = "ar-EG"; // ÿπÿ±ÿ®Ÿä ŸÖÿµÿ±Ÿä
                    speechSynthesis.speak(utterance);
                } else {
                    alert("ŸÖŸÅŸäÿ¥ ÿ±ÿ≥ÿßŸÑÿ© ŸÖŸÜ ÿßŸÑÿ®Ÿàÿ™ ÿπÿ¥ÿßŸÜ ÿ™ÿ™ŸÇÿ±ÿß üéôÔ∏è");
                }
            }

            function startSpeechRecognition() {
                if (!('SpeechRecognition' in window) && !('webkitSpeechRecognition' in window)) {
                    alert("Sorry, your browser does not support speech recognition.");
                    return;
                }

                const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'en-US';
                recognition.continuous = false;
                recognition.interimResults = false;

                recognition.start();

                recognition.onresult = function (event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById("userInput").value = transcript;
                };

                recognition.onerror = function (event) {
                    console.error("Speech recognition error:", event.error);
                };
            }


            window.onload = function () {
                document.getElementById("userInput").addEventListener("keypress", function (e) {
                    if (e.key === "Enter") {
                        sendMessage();
                    }
                });
            };
            function sendMessage() {
                const userInput = document.getElementById("userInput").value;
                if (!userInput.trim()) return;

                // Show user message
                const chatLog = document.getElementById("chatLog");
                chatLog.innerHTML += `<p class="user-message">üë§ ${userInput}</p>`;

                fetch("/chat", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ message: userInput })
                })
                    .then(res => res.json())
                    .then(data => {
                        chatLog.innerHTML += `<p class="bot-message">ü§ñ ${data.response}</p>`;
                        if (data.iframe) {
                            chatLog.innerHTML += data.iframe;
                        }
                        document.getElementById("userInput").value = "";
                        chatLog.scrollTop = chatLog.scrollHeight;
                    })
                    .catch(err => {
                        chatLog.innerHTML += `<p class="bot-message">‚ö†Ô∏è Error: ${err}</p>`;
                    });
            }
        </script>
        <script>
            // Dropdown menu
            document.querySelector('.dropdown').addEventListener('click', function () {
                this.classList.toggle('active');
            });


        </script>
        <script>
            const sandstorm = document.querySelector('.sandstorm');

            window.addEventListener('scroll', () => {
                const scrollY = window.scrollY;
                const windowHeight = window.innerHeight;
                const pageHeight = document.body.scrollHeight;

                // ÿπŸÜÿØ ÿßŸÇÿ™ÿ±ÿßÿ® ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸÜ ÿ£ÿ≥ŸÅŸÑ ÿßŸÑÿµŸÅÿ≠ÿ© (ÿßŸÑÿµÿ≠ÿ±ÿßÿ°)
                if (scrollY + windowHeight >= pageHeight - 200) {
                    sandstorm.style.opacity = '0.3';
                } else {
                    sandstorm.style.opacity = '0';
                }
            })
        </script>


    </body>

</html>